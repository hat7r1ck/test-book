## Risk Score Calculation

### Overview

The **Risk Score** is a quantitative measure used to assess the potential risk associated with a specific user authentication event. This score is derived by evaluating various authentication characteristics against the user's historical data, with each characteristic contributing to the overall risk based on predefined weights.

### Components and Weights

Each authentication characteristic is assigned a weight reflecting its importance in the risk assessment. The characteristics and their corresponding weights are defined in the configuration settings:

- **Source IP Address:** 10%
- **Device ID:** 15%
- **User Agent:** 10%
- **Login Hour:** 10%
- **Authentication Type:** 10%
- **Authentication Result:** 10%
- **Location:** 15%
- **Application:** 10%
- **Carrier Name:** 10%

### Calculation Steps

The risk score is calculated through the following steps:

1. **Characteristic Evaluation:**
   
   For each authentication characteristic, determine whether the value in the current authentication event has been seen in the user's historical data.

   - **Seen Before:** If the characteristic's value matches any previous event, it indicates consistency with historical behavior.
   - **Unseen/Unique:** If the characteristic's value is new or differs significantly from historical data, it may indicate anomalous or potentially malicious activity.

2. **Assigning Contributions:**
   
   - **Seen Before:** Assign a **0%** contribution to the risk score for this characteristic.
   - **Unseen/Unique:** Assign the full **weight** of the characteristic to the risk score.

3. **Total Risk Score:**
   
   Sum the contributions from all characteristics to obtain the **Total Risk Score**.

   \[
   \text{Total Risk Score} = \sum (\text{Contribution of each characteristic})
   \]

4. **Risk Percentage:**
   
   Calculate the **Risk Percentage** relative to the **Maximum Possible Score**.

   \[
   \text{Risk Percentage} = \left( \frac{\text{Total Risk Score}}{\text{Maximum Possible Score}} \right) \times 100\%
   \]
   
   - **Maximum Possible Score:** The sum of all characteristic weights. In this configuration, the maximum score is **100%**.

5. **Determining Risk Level:**
   
   Categorize the **Risk Percentage** into one of the predefined risk levels based on the following thresholds:

   - **Low Risk (0% - 20%)**
   - **Moderate Risk (21% - 50%)**
   - **High Risk (51% - 85%)**
   - **Critical Risk (86% - 100%)**

   The corresponding conclusion and recommendation are retrieved from the `risk_level_recommendations` configuration.

### Example Calculation

Let's consider an authentication event with the following characteristics:

- **Source IP Address:** Seen before (Weight: 10%) → Contribution: 0%
- **Device ID:** Unseen (Weight: 15%) → Contribution: 15%
- **User Agent:** Seen before (Weight: 10%) → Contribution: 0%
- **Login Hour:** Unseen (Weight: 10%) → Contribution: 10%
- **Authentication Type:** Seen before (Weight: 10%) → Contribution: 0%
- **Authentication Result:** Unseen (Weight: 10%) → Contribution: 10%
- **Location:** Seen before (Weight: 15%) → Contribution: 0%
- **Application:** Unseen (Weight: 10%) → Contribution: 10%
- **Carrier Name:** Seen before (Weight: 10%) → Contribution: 0%

**Total Risk Score:**

\[
\text{Total Risk Score} = 0 + 15 + 0 + 10 + 0 + 10 + 0 + 10 + 0 = 45\%
\]

**Risk Percentage:**

\[
\text{Risk Percentage} = \left( \frac{45}{100} \right) \times 100\% = 45\%
\]

**Risk Level:**

- **Moderate Risk (21% - 50%)**

**Conclusion:**

- *The authentication event is somewhat unusual compared to historical patterns.*

**Recommendation:**

- *Review the event for any anomalies.*

### Summary

The **Risk Score** provides a structured and quantifiable assessment of authentication events, enabling security teams to prioritize investigations and respond effectively to potential threats. By considering multiple authentication characteristics and their historical consistency, the notebook ensures a comprehensive evaluation of each event's risk level.
